{"version":3,"file":"stimulus_reflex.min.js","sources":["../node_modules/toastify-js/src/toastify-es.js","../javascript/version_checker.js","../javascript/deprecate.js","../javascript/debug.js","../javascript/schema.js","../javascript/utils.js","../javascript/reflexes.js","../javascript/lifecycle.js","../javascript/app.js","../javascript/isolation_mode.js","../javascript/reflex.js","../javascript/process.js","../javascript/transports/action_cable.js","../javascript/log.js","../javascript/attributes.js","../javascript/reflex_data.js","../javascript/transport.js","../javascript/callbacks.js","../javascript/controllers.js","../javascript/scanner.js","../javascript/stimulus_reflex.js","../javascript/index.js"],"sourcesContent":["/*!\n * Toastify js 1.12.0\n * https://github.com/apvarun/toastify-js\n * @license MIT licensed\n *\n * Copyright (C) 2018 Varun A P\n */\n\n/**\n * Options used for Toastify\n * @typedef {Object} ToastifyConfigurationObject\n * @property {string} text - Message to be displayed in the toast\n * @property {Element} node - Provide a node to be mounted inside the toast. node takes higher precedence over text\n * @property {number} duration - Duration for which the toast should be displayed. -1 for permanent toast\n * @property {string|Element} selector - CSS ID Selector on which the toast should be added\n * @property {url} destination - URL to which the browser should be navigated on click of the toast\n * @property {boolean} newWindow - Decides whether the destination should be opened in a new window or not\n * @property {boolean} close - To show the close icon or not\n * @property {string} gravity - To show the toast from top or bottom\n * @property {string} position - To show the toast on left or right\n * @property {string} backgroundColor - Deprecated: Sets the background color of the toast\n * @property {url} avatar - Image/icon to be shown before text\n * @property {string} className - Ability to provide custom class name for further customization\n * @property {boolean} stopOnFocus - To stop timer when hovered over the toast (Only if duration is set)\n * @property {Function} callback - Invoked when the toast is dismissed\n * @property {Function} onClick - Invoked when the toast is clicked\n * @property {Object} offset - Ability to add some offset to axis\n * @property {boolean} escapeMarkup - Toggle the default behavior of escaping HTML markup\n * @property {string} ariaLive - Use the HTML DOM style property to add styles to toast\n * @property {Object} style - Use the HTML DOM style property to add styles to toast\n */\n\n\nclass Toastify {\n\n    defaults = {\n      oldestFirst: true,\n      text: \"Toastify is awesome!\",\n      node: undefined,\n      duration: 3000,\n      selector: undefined,\n      callback: function() {},\n      destination: undefined,\n      newWindow: false,\n      close: false,\n      gravity: \"toastify-top\",\n      positionLeft: false,\n      position: \"\",\n      backgroundColor: \"\",\n      avatar: \"\",\n      className: \"\",\n      stopOnFocus: true,\n      onClick: function() {},\n      offset: { x: 0, y: 0 },\n      escapeMarkup: true,\n      ariaLive: \"polite\",\n      style: { background: \"\" },\n    };\n\n    constructor(options) {\n      /**\n       * The version of Toastify\n       * @type {string}\n       * @public\n       */\n      this.version = \"1.12.0\";\n\n      /**\n       * The configuration object to configure Toastify\n       * @type {ToastifyConfigurationObject}\n       * @public\n       */\n      this.options = {};\n\n      /**\n       * The element that is the Toast\n       * @type {Element}\n       * @public\n       */\n      this.toastElement = null;\n\n      /**\n       * The root element that contains all the toasts\n       * @type {Element}\n       * @private\n       */\n      this._rootElement = document.body;\n\n      this._init(options);\n    }\n\n    /**\n     * Display the toast\n     * @public\n     */\n    showToast() {\n      // Creating the DOM object for the toast\n      this.toastElement = this._buildToast();\n\n      // Getting the root element to with the toast needs to be added\n      if (typeof this.options.selector === \"string\") {\n        this._rootElement = document.getElementById(this.options.selector);\n      } else if (this.options.selector instanceof HTMLElement || this.options.selector instanceof ShadowRoot) {\n        this._rootElement = this.options.selector;\n      } else {\n        this._rootElement = document.body;\n      }\n\n      // Validating if root element is present in DOM\n      if (!this._rootElement) {\n        throw \"Root element is not defined\";\n      }\n\n      // Adding the DOM element\n      this._rootElement.insertBefore(this.toastElement, this._rootElement.firstChild);\n\n      // Repositioning the toasts in case multiple toasts are present\n      this._reposition();\n\n      if (this.options.duration > 0) {\n        this.toastElement.timeOutValue = window.setTimeout(\n          () => {\n            // Remove the toast from DOM\n            this._removeElement(this.toastElement);\n          },\n          this.options.duration\n        ); // Binding `this` for function invocation\n      }\n\n      // Supporting function chaining\n      return this;\n    }\n\n    /**\n     * Hide the toast\n     * @public\n     */\n    hideToast() {\n      if (this.toastElement.timeOutValue) {\n        clearTimeout(this.toastElement.timeOutValue);\n      }\n      this._removeElement(this.toastElement);\n    }\n\n    /**\n     * Init the Toastify class\n     * @param {ToastifyConfigurationObject} options - The configuration object to configure Toastify\n     * @param {string} [options.text=Hi there!] - Message to be displayed in the toast\n     * @param {Element} [options.node] - Provide a node to be mounted inside the toast. node takes higher precedence over text\n     * @param {number} [options.duration=3000] - Duration for which the toast should be displayed. -1 for permanent toast\n     * @param {string} [options.selector] - CSS Selector on which the toast should be added\n     * @param {url} [options.destination] - URL to which the browser should be navigated on click of the toast\n     * @param {boolean} [options.newWindow=false] - Decides whether the destination should be opened in a new window or not\n     * @param {boolean} [options.close=false] - To show the close icon or not\n     * @param {string} [options.gravity=toastify-top] - To show the toast from top or bottom\n     * @param {string} [options.position=right] - To show the toast on left or right\n     * @param {string} [options.backgroundColor] - Sets the background color of the toast (To be deprecated)\n     * @param {url} [options.avatar] - Image/icon to be shown before text\n     * @param {string} [options.className] - Ability to provide custom class name for further customization\n     * @param {boolean} [options.stopOnFocus] - To stop timer when hovered over the toast (Only if duration is set)\n     * @param {Function} [options.callback] - Invoked when the toast is dismissed\n     * @param {Function} [options.onClick] - Invoked when the toast is clicked\n     * @param {Object} [options.offset] - Ability to add some offset to axis\n     * @param {boolean} [options.escapeMarkup=true] - Toggle the default behavior of escaping HTML markup\n     * @param {string} [options.ariaLive] - Announce the toast to screen readers\n     * @param {Object} [options.style] - Use the HTML DOM style property to add styles to toast\n     * @private\n     */\n    _init(options) {\n\n      // Setting defaults\n      this.options = Object.assign(this.defaults, options);\n\n      if (this.options.backgroundColor) {\n        // This is being deprecated in favor of using the style HTML DOM property\n        console.warn('DEPRECATION NOTICE: \"backgroundColor\" is being deprecated. Please use the \"style.background\" property.');\n      }\n\n      this.toastElement = null;\n\n      this.options.gravity = options.gravity === \"bottom\" ? \"toastify-bottom\" : \"toastify-top\"; // toast position - top or bottom\n      this.options.stopOnFocus = options.stopOnFocus === undefined ? true : options.stopOnFocus; // stop timeout on focus\n      if(options.backgroundColor) {\n        this.options.style.background = options.backgroundColor;\n      }\n    }\n\n    /**\n     * Build the Toastify element\n     * @returns {Element}\n     * @private\n     */\n    _buildToast() {\n      // Validating if the options are defined\n      if (!this.options) {\n        throw \"Toastify is not initialized\";\n      }\n\n      // Creating the DOM object\n      let divElement = document.createElement(\"div\");\n      divElement.className = `toastify on ${this.options.className}`;\n\n      // Positioning toast to left or right or center (default right)\n      divElement.className += ` toastify-${this.options.position}`;\n\n      // Assigning gravity of element\n      divElement.className += ` ${this.options.gravity}`;\n\n      // Loop through our style object and apply styles to divElement\n      for (const property in this.options.style) {\n        divElement.style[property] = this.options.style[property];\n      }\n\n      // Announce the toast to screen readers\n      if (this.options.ariaLive) {\n        divElement.setAttribute('aria-live', this.options.ariaLive)\n      }\n\n      // Adding the toast message/node\n      if (this.options.node && this.options.node.nodeType === Node.ELEMENT_NODE) {\n        // If we have a valid node, we insert it\n        divElement.appendChild(this.options.node)\n      } else {\n        if (this.options.escapeMarkup) {\n          divElement.innerText = this.options.text;\n        } else {\n          divElement.innerHTML = this.options.text;\n        }\n\n        if (this.options.avatar !== \"\") {\n          let avatarElement = document.createElement(\"img\");\n          avatarElement.src = this.options.avatar;\n\n          avatarElement.className = \"toastify-avatar\";\n\n          if (this.options.position == \"left\") {\n            // Adding close icon on the left of content\n            divElement.appendChild(avatarElement);\n          } else {\n            // Adding close icon on the right of content\n            divElement.insertAdjacentElement(\"afterbegin\", avatarElement);\n          }\n        }\n      }\n\n      // Adding a close icon to the toast\n      if (this.options.close === true) {\n        // Create a span for close element\n        let closeElement = document.createElement(\"button\");\n        closeElement.type = \"button\";\n        closeElement.setAttribute(\"aria-label\", \"Close\");\n        closeElement.className = \"toast-close\";\n        closeElement.innerHTML = \"&#10006;\";\n\n        // Triggering the removal of toast from DOM on close click\n        closeElement.addEventListener(\n          \"click\",\n          (event) => {\n            event.stopPropagation();\n            this._removeElement(this.toastElement);\n            window.clearTimeout(this.toastElement.timeOutValue);\n          }\n        );\n\n        //Calculating screen width\n        const width = window.innerWidth > 0 ? window.innerWidth : screen.width;\n\n        // Adding the close icon to the toast element\n        // Display on the right if screen width is less than or equal to 360px\n        if ((this.options.position == \"left\") && width > 360) {\n          // Adding close icon on the left of content\n          divElement.insertAdjacentElement(\"afterbegin\", closeElement);\n        } else {\n          // Adding close icon on the right of content\n          divElement.appendChild(closeElement);\n        }\n      }\n\n      // Clear timeout while toast is focused\n      if (this.options.stopOnFocus && this.options.duration > 0) {\n        // stop countdown\n        divElement.addEventListener(\n          \"mouseover\",\n          (event) => {\n            window.clearTimeout(divElement.timeOutValue);\n          }\n        )\n        // add back the timeout\n        divElement.addEventListener(\n          \"mouseleave\",\n          () => {\n            divElement.timeOutValue = window.setTimeout(\n              () => {\n                // Remove the toast from DOM\n                this._removeElement(divElement);\n              },\n              this.options.duration\n            )\n          }\n        )\n      }\n\n      // Adding an on-click destination path\n      if (typeof this.options.destination !== \"undefined\") {\n        divElement.addEventListener(\n          \"click\",\n          (event) => {\n            event.stopPropagation();\n            if (this.options.newWindow === true) {\n              window.open(this.options.destination, \"_blank\");\n            } else {\n              window.location = this.options.destination;\n            }\n          }\n        );\n      }\n\n      if (typeof this.options.onClick === \"function\" && typeof this.options.destination === \"undefined\") {\n        divElement.addEventListener(\n          \"click\",\n          (event) => {\n            event.stopPropagation();\n            this.options.onClick();\n          }\n        );\n      }\n\n      // Adding offset\n      if (typeof this.options.offset === \"object\") {\n\n        const x = this._getAxisOffsetAValue(\"x\", this.options);\n        const y = this._getAxisOffsetAValue(\"y\", this.options);\n\n        const xOffset = this.options.position == \"left\" ? x : `-${x}`;\n        const yOffset = this.options.gravity == \"toastify-top\" ? y : `-${y}`;\n\n        divElement.style.transform = `translate(${xOffset},${yOffset})`;\n\n      }\n\n      // Returning the generated element\n      return divElement;\n    }\n\n    /**\n     * Remove the toast from the DOM\n     * @param {Element} toastElement\n     */\n    _removeElement(toastElement) {\n      // Hiding the element\n      toastElement.className = toastElement.className.replace(\" on\", \"\");\n\n      // Removing the element from DOM after transition end\n      window.setTimeout(\n        () => {\n          // remove options node if any\n          if (this.options.node && this.options.node.parentNode) {\n            this.options.node.parentNode.removeChild(this.options.node);\n          }\n\n          // Remove the element from the DOM, only when the parent node was not removed before.\n          if (toastElement.parentNode) {\n            toastElement.parentNode.removeChild(toastElement);\n          }\n\n          // Calling the callback function\n          this.options.callback.call(toastElement);\n\n          // Repositioning the toasts again\n          this._reposition();\n        },\n        400\n      ); // Binding `this` for function invocation\n    }\n\n    /**\n     * Position the toast on the DOM\n     * @private\n     */\n    _reposition() {\n\n      // Top margins with gravity\n      let topLeftOffsetSize = {\n        top: 15,\n        bottom: 15,\n      };\n      let topRightOffsetSize = {\n        top: 15,\n        bottom: 15,\n      };\n      let offsetSize = {\n        top: 15,\n        bottom: 15,\n      };\n\n      // Get all toast messages that have been added to the container (selector)\n      let allToasts = this._rootElement.querySelectorAll(\".toastify\");\n\n      let classUsed;\n\n      // Modifying the position of each toast element\n      for (let i = 0; i < allToasts.length; i++) {\n        // Getting the applied gravity\n        if (allToasts[i].classList.contains(\"toastify-top\") === true) {\n          classUsed = \"toastify-top\";\n        } else {\n          classUsed = \"toastify-bottom\";\n        }\n\n        let height = allToasts[i].offsetHeight;\n        classUsed = classUsed.substr(9, classUsed.length - 1)\n        // Spacing between toasts\n        let offset = 15;\n\n        let width = window.innerWidth > 0 ? window.innerWidth : screen.width;\n\n        // Show toast in center if screen with less than or equal to 360px\n        if (width <= 360) {\n          // Setting the position\n          allToasts[i].style[classUsed] = `${offsetSize[classUsed]}px`;\n\n          offsetSize[classUsed] += height + offset;\n        } else {\n          if (allToasts[i].classList.contains(\"toastify-left\") === true) {\n            // Setting the position\n            allToasts[i].style[classUsed] = `${topLeftOffsetSize[classUsed]}px`;\n\n            topLeftOffsetSize[classUsed] += height + offset;\n          } else {\n            // Setting the position\n            allToasts[i].style[classUsed] = `${topRightOffsetSize[classUsed]}px`;\n\n            topRightOffsetSize[classUsed] += height + offset;\n          }\n        }\n      }\n    }\n\n    /**\n     * Helper function to get offset\n     * @param {string} axis - 'x' or 'y'\n     * @param {ToastifyConfigurationObject} options - The options object containing the offset object\n     */\n    _getAxisOffsetAValue(axis, options) {\n\n      if (options.offset[axis]) {\n        if (isNaN(options.offset[axis])) {\n          return options.offset[axis];\n        } else {\n          return `${options.offset[axis]}px`;\n        }\n      }\n\n      return '0px';\n\n    }\n\n  }\n\n\n  // Returning the Toastify function to be assigned to the window object/module\n  function StartToastifyInstance(options) {\n    return new Toastify(options);\n  }\n\n  export default StartToastifyInstance;\n","import Toastify from \"toastify-js/src/toastify-es.js\"\nimport CableReady from \"cable_ready\"\n\nCableReady.operations.stimulusReflexVersionMismatch = operation => {\n  const levels = {\n    \"info\": {},\n    \"success\": { background: \"rgb(0, 176, 155)\" },\n    \"warn\": { background: \"rgb(247, 187, 60)\" },\n    \"error\": { background: \"rgb(255, 95, 109)\" },\n  }\n\n  const defaults = {\n    selector: setupToastify(),\n    close: true,\n    duration: 30 * 1000,\n    gravity: \"bottom\",\n    position: \"right\",\n    newWindow: true,\n    style: levels[operation.level || \"info\"]\n  }\n\n  Toastify({ ...defaults, ...operation }).showToast()\n}\n\nfunction setupToastify() {\n  const id = \"stimulus-reflex-toast-element\"\n  let element = document.querySelector(`#${id}`)\n\n  if (!element) {\n    element = document.createElement(\"div\")\n    element.id = id\n    document.documentElement.appendChild(element)\n\n    const styles = document.createElement(\"style\")\n    styles.innerHTML = `\n      #${id} .toastify {\n         padding: 12px 20px;\n         color: #ffffff;\n         display: inline-block;\n         box-shadow: 0 3px 6px -1px rgba(0, 0, 0, 0.12), 0 10px 36px -4px rgba(77, 96, 232, 0.3);\n         background: -webkit-linear-gradient(315deg, #73a5ff, #5477f5);\n         background: linear-gradient(135deg, #73a5ff, #5477f5);\n         position: fixed;\n         opacity: 0;\n         transition: all 0.4s cubic-bezier(0.215, 0.61, 0.355, 1);\n         border-radius: 2px;\n         cursor: pointer;\n         text-decoration: none;\n         max-width: calc(50% - 20px);\n         z-index: 2147483647;\n         bottom: -150px;\n         right: 15px;\n      }\n\n      #${id} .toastify.on {\n        opacity: 1;\n      }\n\n      #${id} .toast-close {\n        background: transparent;\n        border: 0;\n        color: white;\n        cursor: pointer;\n        font-family: inherit;\n        font-size: 1em;\n        opacity: 0.4;\n        padding: 0 5px;\n      }\n    `\n\n    document.head.appendChild(styles)\n  }\n\n  return element\n}\n","let deprecationWarnings = true\n\nexport default {\n  get enabled () {\n    return deprecationWarnings\n  },\n  get disabled () {\n    return !deprecationWarnings\n  },\n  get value () {\n    return deprecationWarnings\n  },\n  set (value) {\n    deprecationWarnings = !!value\n  },\n  set deprecate (value) {\n    deprecationWarnings = !!value\n  }\n}\n","let debugging = false\n\nexport default {\n  get enabled () {\n    return debugging\n  },\n  get disabled () {\n    return !debugging\n  },\n  get value () {\n    return debugging\n  },\n  set (value) {\n    debugging = !!value\n  },\n  set debug (value) {\n    debugging = !!value\n  }\n}\n","const defaultSchema = {\n  reflexAttribute: 'data-reflex',\n  reflexPermanentAttribute: 'data-reflex-permanent',\n  reflexRootAttribute: 'data-reflex-root',\n  reflexSuppressLoggingAttribute: 'data-reflex-suppress-logging',\n  reflexDatasetAttribute: 'data-reflex-dataset',\n  reflexDatasetAllAttribute: 'data-reflex-dataset-all',\n  reflexSerializeFormAttribute: 'data-reflex-serialize-form',\n  reflexFormSelectorAttribute: 'data-reflex-form-selector',\n  reflexIncludeInnerHtmlAttribute: 'data-reflex-include-inner-html',\n  reflexIncludeTextContentAttribute: 'data-reflex-include-text-content'\n}\n\nlet schema = {}\n\nexport { schema, defaultSchema }\n\nexport default {\n  set (application) {\n    schema = { ...defaultSchema, ...application.schema }\n    for (const attribute in schema) {\n      const attributeName = attribute.slice(0, -9)\n\n      Object.defineProperty(this, attributeName, {\n        get: () => {\n          return schema[attribute]\n        },\n        configurable: true\n      })\n    }\n  }\n}\n","import Debug from './debug'\nimport Deprecate from './deprecate'\nimport Schema from './schema'\n\nimport { Utils } from 'cable_ready'\n\nconst { debounce, dispatch, xpathToElement, xpathToElementArray } = Utils\n\n// uuid4 function taken from stackoverflow\n// https://stackoverflow.com/a/2117523/554903\n\nconst uuidv4 = () => {\n  const crypto = window.crypto || window.msCrypto\n  return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>\n    (\n      c ^\n      (crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (c / 4)))\n    ).toString(16)\n  )\n}\n\nconst serializeForm = (form, options = {}) => {\n  if (!form) return ''\n\n  const w = options.w || window\n  const { element } = options\n  const formData = new w.FormData(form)\n  const data = Array.from(formData, e => e.map(encodeURIComponent).join('='))\n  const submitButton = form.querySelector('input[type=submit]')\n  if (\n    element &&\n    element.name &&\n    element.nodeName === 'INPUT' &&\n    element.type === 'submit'\n  ) {\n    data.push(\n      `${encodeURIComponent(element.name)}=${encodeURIComponent(element.value)}`\n    )\n  } else if (submitButton && submitButton.name) {\n    data.push(\n      `${encodeURIComponent(submitButton.name)}=${encodeURIComponent(\n        submitButton.value\n      )}`\n    )\n  }\n  return Array.from(data).join('&')\n}\n\nconst camelize = (value, uppercaseFirstLetter = true) => {\n  if (typeof value !== 'string') return ''\n  value = value\n    .replace(/[\\s_](.)/g, $1 => $1.toUpperCase())\n    .replace(/[\\s_]/g, '')\n    .replace(/^(.)/, $1 => $1.toLowerCase())\n\n  if (uppercaseFirstLetter)\n    value = value.substr(0, 1).toUpperCase() + value.substr(1)\n\n  return value\n}\n\n// TODO: remove this in v4 (potentially!)\nconst XPathToElement = xpathToElement\nconst XPathToArray = xpathToElementArray\nconst emitEvent = (name, detail = {}) => dispatch(document, name, detail)\n\nconst extractReflexName = reflexString => {\n  const match = reflexString.match(/(?:.*->)?(.*?)(?:Reflex)?#/)\n\n  return match ? match[1] : ''\n}\n\n// construct a valid xPath for an element in the DOM\nconst elementToXPath = element => {\n  if (element.id !== '') return \"//*[@id='\" + element.id + \"']\"\n  if (element === document.body) return '/html/body'\n  if (element.nodeName === 'HTML') return '/html'\n\n  let ix = 0\n  const siblings =\n    element && element.parentNode ? element.parentNode.childNodes : []\n\n  for (var i = 0; i < siblings.length; i++) {\n    const sibling = siblings[i]\n    if (sibling === element) {\n      const computedPath = elementToXPath(element.parentNode)\n      const tagName = element.tagName.toLowerCase()\n      const ixInc = ix + 1\n      return `${computedPath}/${tagName}[${ixInc}]`\n    }\n\n    if (sibling.nodeType === 1 && sibling.tagName === element.tagName) {\n      ix++\n    }\n  }\n}\n\nconst elementInvalid = element => {\n  return (\n    element.type === 'number' && element.validity && element.validity.badInput\n  )\n}\n\nconst getReflexElement = (args, element) => {\n  return args[0] && args[0].nodeType === Node.ELEMENT_NODE\n    ? args.shift()\n    : element\n}\n\nconst getReflexOptions = args => {\n  const options = {}\n  // TODO: remove reflexId in v4\n  if (\n    args[0] &&\n    typeof args[0] === 'object' &&\n    Object.keys(args[0]).filter(key =>\n      [\n        'id',\n        'attrs',\n        'selectors',\n        'reflexId',\n        'resolveLate',\n        'serializeForm',\n        'suppressLogging',\n        'includeInnerHTML',\n        'includeTextContent'\n      ].includes(key)\n    ).length\n  ) {\n    const opts = args.shift()\n    // TODO: in v4, all promises resolve during finalize stage\n    // if they specify resolveLate, console.warn to say that the option will be ignored\n    // deprecation warning in 3.5 is not required as it's still required until v4\n    Object.keys(opts).forEach(o => {\n      // TODO: no need to check for reflexId in v4\n      if (o === 'reflexId') {\n        if (Deprecate.enabled)\n          console.warn('reflexId option will be removed in v4. Use id instead.')\n        options['id'] = opts['reflexId']\n      } else options[o] = opts[o]\n    })\n  }\n  return options\n}\n\n// compute the DOM element(s) which will be the morph root\n// use the data-reflex-root attribute on the reflex or the controller\n// optional value is a CSS selector(s); comma-separated list\n// order of preference is data-reflex, data-controller, document body (default)\nconst getReflexRoots = element => {\n  let list = []\n  while (list.length === 0 && element) {\n    let reflexRoot = element.getAttribute(Schema.reflexRoot)\n    if (reflexRoot) {\n      if (reflexRoot.length === 0 && element.id) reflexRoot = `#${element.id}`\n      const selectors = reflexRoot.split(',').filter(s => s.trim().length)\n      if (Debug.enabled && selectors.length === 0) {\n        console.error(\n          `No value found for ${Schema.reflexRoot}. Add an #id to the element or provide a value for ${Schema.reflexRoot}.`,\n          element\n        )\n      }\n      list = list.concat(selectors.filter(s => document.querySelector(s)))\n    }\n    element = element.parentElement\n      ? element.parentElement.closest(`[${Schema.reflexRoot}]`)\n      : null\n  }\n  return list\n}\n\nexport {\n  uuidv4,\n  serializeForm,\n  camelize,\n  debounce,\n  dispatch,\n  extractReflexName,\n  emitEvent,\n  elementToXPath,\n  XPathToElement,\n  XPathToArray,\n  elementInvalid,\n  getReflexElement,\n  getReflexOptions,\n  getReflexRoots\n}\n","const stages = [\n  'created',\n  'before',\n  'delivered',\n  'queued',\n  'after',\n  'finalized',\n  'success',\n  'error',\n  'halted',\n  'forbidden'\n]\nlet lastReflex\n\nexport const reflexes = new Proxy(\n  {}, // You are standing in an open field west of a white house, with a boarded front door.\n  {\n    get: function (target, prop) {\n      if (stages.includes(prop))\n        return Object.fromEntries(\n          Object.entries(target).filter(([_, reflex]) => reflex.stage === prop)\n        )\n      else if (prop === 'last') return lastReflex\n      else if (prop === 'all') return target\n      return Reflect.get(...arguments)\n    },\n    set: function (target, prop, value) {\n      target[prop] = value\n      lastReflex = value\n      return true\n    }\n  }\n)\n","import Debug from './debug'\n\nimport { camelize } from './utils'\nimport { reflexes } from './reflexes'\n\n// lifecycle stages\n//   * created (at initialization)\n//   * before\n//   * delivered\n//   * queued\n//   * success\n//   * error\n//   * halted\n//   * forbidden\n//   * after\n//   * finalize\n\n// Invokes a lifecycle method on a StimulusReflex controller.\n// - reflex - the Reflex object\n// - stage - the lifecycle stage\n//\nconst invokeLifecycleMethod = (reflex, stage) => {\n  // TODO: v4 reevaluate benefit of naming complexity vs semantic payoff\n  const specificLifecycleMethod =\n    reflex.controller[\n      ['before', 'after', 'finalize'].includes(stage)\n        ? `${stage}${camelize(reflex.action)}`\n        : `${camelize(reflex.action, false)}${camelize(stage)}`\n    ]\n\n  const genericLifecycleMethod =\n    reflex.controller[\n      ['before', 'after', 'finalize'].includes(stage)\n        ? `${stage}Reflex`\n        : `reflex${camelize(stage)}`\n    ]\n\n  // TODO: v4 just pass reflex into the lifecycle method\n  if (typeof specificLifecycleMethod === 'function') {\n    specificLifecycleMethod.call(\n      reflex.controller,\n      reflex.element,\n      reflex.target,\n      reflex.error,\n      reflex.id,\n      reflex.payload\n    )\n  }\n\n  // TODO: v4 just pass reflex into the lifecycle method\n  if (typeof genericLifecycleMethod === 'function') {\n    genericLifecycleMethod.call(\n      reflex.controller,\n      reflex.element,\n      reflex.target,\n      reflex.error,\n      reflex.id,\n      reflex.payload\n    )\n  }\n}\n\n// Dispatches a lifecycle event on document\n// - reflex - the Reflex object\n// - stage - the lifecycle stage\n//\nconst dispatchLifecycleEvent = (reflex, stage) => {\n  if (!reflex.controller.element.parentElement) {\n    if (Debug.enabled && !reflex.warned) {\n      console.warn(\n        `StimulusReflex was not able execute callbacks or emit events for \"${stage}\" or later life-cycle stages for this Reflex. The StimulusReflex Controller Element is no longer present in the DOM. Could you move the StimulusReflex Controller to an element higher in your DOM?`\n      )\n      reflex.warned = true\n    }\n    return\n  }\n\n  reflex.stage = stage\n  reflex.lifecycle.push(stage)\n\n  const event = `stimulus-reflex:${stage}`\n  const action = `${event}:${reflex.action}`\n  // TODO: v4 detail = reflex\n  const detail = {\n    reflex: reflex.target,\n    controller: reflex.controller,\n    id: reflex.id,\n    element: reflex.element,\n    payload: reflex.payload\n  }\n  const options = { bubbles: true, cancelable: false, detail }\n\n  reflex.controller.element.dispatchEvent(new CustomEvent(event, options))\n  reflex.controller.element.dispatchEvent(new CustomEvent(action, options))\n\n  if (window.jQuery) {\n    window.jQuery(reflex.controller.element).trigger(event, detail)\n    window.jQuery(reflex.controller.element).trigger(action, detail)\n  }\n}\n\ndocument.addEventListener(\n  'stimulus-reflex:before',\n  event => invokeLifecycleMethod(reflexes[event.detail.id], 'before'),\n  true\n)\n\ndocument.addEventListener(\n  'stimulus-reflex:queued',\n  event => invokeLifecycleMethod(reflexes[event.detail.id], 'queued'),\n  true\n)\n\ndocument.addEventListener(\n  'stimulus-reflex:delivered',\n  event => invokeLifecycleMethod(reflexes[event.detail.id], 'delivered'),\n  true\n)\n\ndocument.addEventListener(\n  'stimulus-reflex:success',\n  event => {\n    const reflex = reflexes[event.detail.id]\n    invokeLifecycleMethod(reflex, 'success')\n    dispatchLifecycleEvent(reflex, 'after')\n  },\n  true\n)\n\ndocument.addEventListener(\n  'stimulus-reflex:nothing',\n  event => dispatchLifecycleEvent(reflexes[event.detail.id], 'success'),\n  true\n)\n\ndocument.addEventListener(\n  'stimulus-reflex:error',\n  event => {\n    const reflex = reflexes[event.detail.id]\n    invokeLifecycleMethod(reflex, 'error')\n    // TODO: v4 remove after events on error; behave like halted and forbidden\n    dispatchLifecycleEvent(reflex, 'after')\n  },\n  true\n)\n\ndocument.addEventListener(\n  'stimulus-reflex:halted',\n  event => invokeLifecycleMethod(reflexes[event.detail.id], 'halted'),\n  true\n)\n\ndocument.addEventListener(\n  'stimulus-reflex:forbidden',\n  event => invokeLifecycleMethod(reflexes[event.detail.id], 'forbidden'),\n  true\n)\n\ndocument.addEventListener(\n  'stimulus-reflex:after',\n  event => invokeLifecycleMethod(reflexes[event.detail.id], 'after'),\n  true\n)\n\ndocument.addEventListener(\n  'stimulus-reflex:finalize',\n  event => invokeLifecycleMethod(reflexes[event.detail.id], 'finalize'),\n  true\n)\n\nexport { dispatchLifecycleEvent }\n","let app = {}\n\nexport default {\n  get app () {\n    return app\n  },\n  set (application) {\n    app = application\n  }\n}\n","import Deprecate from './deprecate'\n\nlet isolationMode = false\n\nexport default {\n  get disabled () {\n    return !isolationMode\n  },\n  set (value) {\n    isolationMode = value\n    if (Deprecate.enabled && !isolationMode) {\n      document.addEventListener(\n        'DOMContentLoaded',\n        () =>\n          console.warn(\n            'Deprecation warning: the next version of StimulusReflex will standardize isolation mode, and the isolate option will be removed.\\nPlease update your applications to assume that every tab will be isolated. Use CableReady operations to broadcast updates to other tabs and users.'\n          ),\n        { once: true }\n      )\n    }\n  }\n}\n","import Debug from './debug'\nimport Deprecate from './deprecate'\n\nexport default class Reflex {\n  constructor (data, controller) {\n    this.data = data.valueOf()\n    this.controller = controller\n    this.element = data.reflexElement\n    this.id = data.id\n    this.error = null\n    this.payload = null\n    this.stage = 'created'\n    this.lifecycle = ['created']\n    this.warned = false\n    this.target = data.target\n    this.action = data.target.split('#')[1]\n    this.selector = null\n    this.morph = null\n    this.operation = null\n    this.timestamp = new Date()\n    this.cloned = false // TODO: v4 remove\n  }\n\n  get getPromise () {\n    const promise = new Promise((resolve, reject) => {\n      this.promise = {\n        resolve,\n        reject,\n        data: this.data\n      }\n    })\n    promise.id = this.id\n    // TODO: v4 remove\n    Object.defineProperty(promise, 'reflexId', {\n      get () {\n        if (Deprecate.enabled)\n          console.warn(\n            'reflexId is deprecated and will be removed from v4. Use id instead.'\n          )\n        return this.id\n      }\n    })\n    // END TODO: v4 remove\n    promise.reflex = this\n    if (Debug.enabled) promise.catch(() => {})\n    return promise\n  }\n}\n","import CableReady from 'cable_ready'\n\nimport App from './app'\nimport Debug from './debug'\nimport IsolationMode from './isolation_mode'\nimport Reflex from './reflex'\n\nimport { dispatchLifecycleEvent } from './lifecycle'\nimport { reflexes } from './reflexes'\nimport { XPathToElement } from './utils'\n\nexport const received = data => {\n  if (!data.cableReady) return\n\n  if (data.version.replace('.pre', '-pre') !== CableReady.version) {\n    if (Debug.enabled)\n      console.error(\n        `Reflex failed due to cable_ready gem/NPM package version mismatch. Package versions must match exactly.\\nNote that if you are using pre-release builds, gems use the \"x.y.z.preN\" version format, while NPM packages use \"x.y.z-preN\".\\n\\ncable_ready gem: ${data.version}\\ncable_ready NPM: ${CableReady.version}`\n      )\n    return\n  }\n\n  let reflexOperations = []\n\n  for (let i = data.operations.length - 1; i >= 0; i--) {\n    if (data.operations[i].stimulusReflex) {\n      reflexOperations.push(data.operations[i])\n      data.operations.splice(i, 1)\n    }\n  }\n\n  if (\n    reflexOperations.some(\n      operation => operation.stimulusReflex.url !== location.href\n    )\n  ) {\n    if (Debug.enabled) {\n      console.error('Reflex failed due to mismatched URL.')\n      return\n    }\n  }\n\n  let reflexData\n\n  if (reflexOperations.length) {\n    reflexData = reflexOperations[0].stimulusReflex\n    reflexData.payload = reflexOperations[0].payload\n  }\n\n  if (reflexData) {\n    const { id, payload } = reflexData\n    let reflex\n\n    // TODO: remove this in v4\n    if (!reflexes[id] && IsolationMode.disabled) {\n      const controllerElement = XPathToElement(reflexData.xpathController)\n      const reflexElement = XPathToElement(reflexData.xpathElement)\n\n      controllerElement.reflexController =\n        controllerElement.reflexController || {}\n      controllerElement.reflexData = controllerElement.reflexData || {}\n      controllerElement.reflexError = controllerElement.reflexError || {}\n\n      const controller = App.app.getControllerForElementAndIdentifier(\n        controllerElement,\n        reflexData.reflexController\n      )\n\n      controllerElement.reflexController[id] = controller\n      controllerElement.reflexData[id] = reflexData\n\n      reflex = new Reflex(reflexData, controller)\n      reflexes[id] = reflex\n      reflex.cloned = true\n      reflex.element = reflexElement\n      controller.lastReflex = reflex\n\n      dispatchLifecycleEvent(reflex, 'before')\n      reflex.getPromise\n    } else {\n      // v4 keep this, make it a const\n      reflex = reflexes[id]\n    }\n    // END TODO: remove\n\n    if (reflex) {\n      reflex.payload = payload\n      reflex.totalOperations = reflexOperations.length\n      reflex.pendingOperations = reflexOperations.length\n      reflex.completedOperations = 0\n      reflex.piggybackOperations = data.operations\n      CableReady.perform(reflexOperations)\n    }\n  } else {\n    if (data.operations.length && reflexes[data.operations[0].reflexId]) {\n      CableReady.perform(data.operations)\n    }\n  }\n}\n","import Deprecate from '../deprecate'\n\nimport { createConsumer } from '@rails/actioncable'\nimport { dispatchLifecycleEvent } from '../lifecycle'\nimport { emitEvent } from '../utils'\nimport { received } from '../process'\nimport { reflexes } from '../reflexes'\n\nlet consumer\nlet params\nlet subscription\nlet active\n\nconst initialize = (consumerValue, paramsValue) => {\n  consumer = consumerValue\n  params = paramsValue\n  document.addEventListener('DOMContentLoaded', () => {\n    active = false\n    connectionStatusClass()\n    if (Deprecate.enabled && consumerValue)\n      console.warn(\n        \"Deprecation warning: the next version of StimulusReflex will obtain a reference to consumer via the Stimulus application object.\\nPlease add 'application.consumer = consumer' to your index.js after your Stimulus application has been established, and remove the consumer key from your StimulusReflex initialize() options object.\"\n      )\n  })\n  document.addEventListener('turbolinks:load', connectionStatusClass)\n  document.addEventListener('turbo:load', connectionStatusClass)\n}\n\nconst subscribe = controller => {\n  if (subscription) return\n  consumer = consumer || controller.application.consumer || createConsumer()\n  const { channel } = controller.StimulusReflex\n  const request = { channel, ...params }\n  const identifier = JSON.stringify(request)\n\n  subscription =\n    consumer.subscriptions.findAll(identifier)[0] ||\n    consumer.subscriptions.create(request, {\n      received,\n      connected,\n      rejected,\n      disconnected\n    })\n}\n\nconst connected = () => {\n  active = true\n  connectionStatusClass()\n  emitEvent('stimulus-reflex:connected')\n  Object.values(reflexes.queued).forEach(reflex => {\n    subscription.send(reflex.data)\n    dispatchLifecycleEvent(reflex, 'delivered')\n  })\n}\n\nconst rejected = () => {\n  active = false\n  connectionStatusClass()\n  emitEvent('stimulus-reflex:rejected')\n  if (Debug.enabled) console.warn('Channel subscription was rejected.')\n}\n\nconst disconnected = willAttemptReconnect => {\n  active = false\n  connectionStatusClass()\n  emitEvent('stimulus-reflex:disconnected', willAttemptReconnect)\n}\n\nconst deliver = reflex => {\n  if (active) {\n    subscription.send(reflex.data)\n    dispatchLifecycleEvent(reflex, 'delivered')\n  } else dispatchLifecycleEvent(reflex, 'queued')\n}\n\nconst connectionStatusClass = () => {\n  const list = document.body.classList\n  if (\n    !(\n      list.contains('stimulus-reflex-connected') ||\n      list.contains('stimulus-reflex-disconnected')\n    )\n  ) {\n    list.add(\n      active ? 'stimulus-reflex-connected' : 'stimulus-reflex-disconnected'\n    )\n    return\n  }\n  if (active) {\n    list.replace('stimulus-reflex-disconnected', 'stimulus-reflex-connected')\n  } else {\n    list.replace('stimulus-reflex-connected', 'stimulus-reflex-disconnected')\n  }\n}\n\nexport default {\n  subscribe,\n  deliver,\n  initialize\n}\n","import Debug from './debug'\n\nconst request = reflex => {\n  if (Debug.disabled || reflex.data.suppressLogging) return\n  console.log(`\\u2191 stimulus \\u2191 ${reflex.target}`, {\n    id: reflex.id,\n    args: reflex.data.args,\n    controller: reflex.controller.identifier,\n    element: reflex.element,\n    controllerElement: reflex.controller.element\n  })\n}\n\nconst success = reflex => {\n  if (Debug.disabled || reflex.data.suppressLogging) return\n  const output = {\n    id: reflex.id,\n    morph: reflex.morph,\n    payload: reflex.payload\n  }\n  if (reflex.operation !== 'dispatch_event') output.operation = reflex.operation\n  console.log(\n    `\\u2193 reflex \\u2193 ${reflex.target} \\u2192 ${reflex.selector ||\n      '\\u221E'}${progress(reflex)} ${duration(reflex)}`,\n    output\n  )\n}\n\nconst halted = reflex => {\n  if (Debug.disabled || reflex.data.suppressLogging) return\n  console.log(\n    `\\u2193 reflex \\u2193 ${reflex.target} ${duration(reflex)} %cHALTED`,\n    'color: #ffa500;',\n    { id: reflex.id, payload: reflex.payload }\n  )\n}\n\nconst forbidden = reflex => {\n  if (Debug.disabled || reflex.data.suppressLogging) return\n  console.log(\n    `\\u2193 reflex \\u2193 ${reflex.target} ${duration(reflex)} %cFORBIDDEN`,\n    'color: #BF40BF;',\n    { id: reflex.id, payload: reflex.payload }\n  )\n}\n\nconst error = reflex => {\n  if (Debug.disabled || reflex.data.suppressLogging) return\n  console.log(\n    `\\u2193 reflex \\u2193 ${reflex.target} ${duration(reflex)} %cERROR: ${\n      reflex.error\n    }`,\n    'color: #f00;',\n    { id: reflex.id, payload: reflex.payload }\n  )\n}\n\nconst duration = reflex => {\n  return !reflex.cloned ? `in ${new Date() - reflex.timestamp}ms` : 'CLONED'\n}\n\nconst progress = reflex => {\n  return reflex.totalOperations > 1\n    ? ` ${reflex.completedOperations}/${reflex.totalOperations}`\n    : ''\n}\n\nexport default { request, success, halted, forbidden, error }\n","import Debug from './debug'\nimport Deprecate from './deprecate'\nimport Schema from './schema'\n\nimport { elementToXPath, XPathToArray } from './utils'\n\nconst multipleInstances = element => {\n  if (['checkbox', 'radio'].includes(element.type)) {\n    return (\n      document.querySelectorAll(\n        `input[type=\"${element.type}\"][name=\"${element.name}\"]`\n      ).length > 1\n    )\n  }\n  return false\n}\nconst collectCheckedOptions = element => {\n  return Array.from(element.querySelectorAll('option:checked'))\n    .concat(\n      Array.from(\n        document.querySelectorAll(\n          `input[type=\"${element.type}\"][name=\"${element.name}\"]`\n        )\n      ).filter(elem => elem.checked)\n    )\n    .map(o => o.value)\n}\n\n// Returns a string value for the passed array.\n//\n//   attributeValue(['', 'one', null, 'two', 'three ']) // 'one two three'\n//\nconst attributeValue = (values = []) => {\n  const value = Array.from(\n    new Set(\n      values\n      .filter(v => v && String(v).length)\n      .map(v => v.trim())\n    )\n  ).join(' ').trim()\n\n  return value.length > 0 ? value : null\n}\n\n// Returns an array for the passed string value by splitting on whitespace.\n//\n//   attributeValues('one two three ') // ['one', 'two', 'three']\n//\nconst attributeValues = value => {\n  if (!value) return []\n  if (!value.length) return []\n  return value.split(' ').filter(v => v.trim().length)\n}\n\n// Extracts attributes from a DOM element.\n//\nconst extractElementAttributes = element => {\n  let attrs = Array.from(element.attributes).reduce((memo, attr) => {\n    memo[attr.name] = attr.value\n    return memo\n  }, {})\n\n  attrs.checked = !!element.checked\n  attrs.selected = !!element.selected\n  attrs.tag_name = element.tagName\n\n  if (element.tagName.match(/select/i) || multipleInstances(element)) {\n    const collectedOptions = collectCheckedOptions(element)\n    attrs.values = collectedOptions\n    attrs.value = collectedOptions.join(',')\n  } else {\n    attrs.value = element.value\n  }\n  return attrs\n}\n\n// Returns an array of elements for the provided tokens.\n// Tokens is an array of space separated string coming from the `data-reflex-dataset`\n// or `data-reflex-dataset-all` attribute.\n//\nconst getElementsFromTokens = (element, tokens) => {\n  if (!tokens || tokens.length === 0) return []\n\n  let elements = [element]\n\n  const xPath = elementToXPath(element)\n\n  tokens.forEach(token => {\n    try {\n      switch (token) {\n        case 'combined':\n          if (Deprecate.enabled)\n            console.warn(\n              \"In the next version of StimulusReflex, the 'combined' option to data-reflex-dataset will become 'ancestors'.\"\n            )\n          elements = [\n            ...elements,\n            ...XPathToArray(`${xPath}/ancestor::*`, true)\n          ]\n          break\n        case 'ancestors':\n          elements = [\n            ...elements,\n            ...XPathToArray(`${xPath}/ancestor::*`, true)\n          ]\n          break\n        case 'parent':\n          elements = [...elements, ...XPathToArray(`${xPath}/parent::*`)]\n          break\n        case 'siblings':\n          elements = [\n            ...elements,\n            ...XPathToArray(\n              `${xPath}/preceding-sibling::*|${xPath}/following-sibling::*`\n            )\n          ]\n          break\n        case 'children':\n          elements = [...elements, ...XPathToArray(`${xPath}/child::*`)]\n          break\n        case 'descendants':\n          elements = [...elements, ...XPathToArray(`${xPath}/descendant::*`)]\n          break\n        default:\n          elements = [...elements, ...document.querySelectorAll(token)]\n      }\n    } catch (error) {\n      if (Debug.enabled) console.error(error)\n    }\n  })\n\n  return elements\n}\n\n// Extracts the dataset of an element and combines it with the data attributes from all specified tokens\n//\nconst extractElementDataset = element => {\n  const dataset = element.attributes[Schema.reflexDataset]\n  const allDataset = element.attributes[Schema.reflexDatasetAll]\n\n  const tokens = (dataset && dataset.value.split(' ')) || []\n  const allTokens = (allDataset && allDataset.value.split(' ')) || []\n\n  const datasetElements = getElementsFromTokens(element, tokens)\n  const datasetAllElements = getElementsFromTokens(element, allTokens)\n\n  const datasetAttributes = datasetElements.reduce((acc, ele) => {\n    return { ...extractDataAttributes(ele), ...acc }\n  }, {})\n\n  const reflexElementAttributes = extractDataAttributes(element)\n\n  const elementDataset = {\n    dataset: { ...reflexElementAttributes, ...datasetAttributes },\n    datasetAll: {}\n  }\n\n  datasetAllElements.forEach(element => {\n    const elementAttributes = extractDataAttributes(element)\n\n    Object.keys(elementAttributes).forEach(key => {\n      const value = elementAttributes[key]\n\n      if (\n        elementDataset.datasetAll[key] &&\n        Array.isArray(elementDataset.datasetAll[key])\n      ) {\n        elementDataset.datasetAll[key].push(value)\n      } else {\n        elementDataset.datasetAll[key] = [value]\n      }\n    })\n  })\n\n  return elementDataset\n}\n\n// Extracts all data attributes from a DOM element.\n//\nconst extractDataAttributes = element => {\n  let attrs = {}\n\n  if (element && element.attributes) {\n    Array.from(element.attributes).forEach(attr => {\n      if (attr.name.startsWith('data-')) {\n        attrs[attr.name] = attr.value\n      }\n    })\n  }\n\n  return attrs\n}\n\nexport {\n  attributeValue,\n  attributeValues,\n  extractElementAttributes,\n  extractElementDataset,\n  extractDataAttributes\n}\n","import Schema from './schema'\n\nimport { extractElementAttributes, extractElementDataset } from './attributes'\nimport { uuidv4, getReflexRoots, elementToXPath } from './utils'\n\nimport packageInfo from '../package.json'\n\nexport default class ReflexData {\n  constructor (\n    options,\n    reflexElement,\n    controllerElement,\n    reflexController,\n    permanentAttributeName,\n    target,\n    args,\n    url,\n    tabId\n  ) {\n    this.options = options\n    this.reflexElement = reflexElement\n    this.controllerElement = controllerElement\n    this.reflexController = reflexController\n    this.permanentAttributeName = permanentAttributeName\n    this.target = target\n    this.args = args\n    this.url = url\n    this.tabId = tabId\n  }\n\n  get attrs () {\n    this._attrs =\n      this._attrs ||\n      this.options['attrs'] ||\n      extractElementAttributes(this.reflexElement)\n\n    return this._attrs\n  }\n\n  get id () {\n    this._id = this._id || this.options['id'] || uuidv4()\n    return this._id\n  }\n\n  get selectors () {\n    this._selectors =\n      this._selectors ||\n      this.options['selectors'] ||\n      getReflexRoots(this.reflexElement)\n\n    return typeof this._selectors === 'string'\n      ? [this._selectors]\n      : this._selectors\n  }\n\n  // TODO: v4 always resolve late\n  get resolveLate () {\n    return this.options['resolveLate'] || false\n  }\n\n  get dataset () {\n    this._dataset = this._dataset || extractElementDataset(this.reflexElement)\n    return this._dataset\n  }\n\n  get innerHTML () {\n    return this.includeInnerHtml ? this.reflexElement.innerHTML : ''\n  }\n\n  get textContent () {\n    return this.includeTextContent ? this.reflexElement.textContent : ''\n  }\n\n  // TODO: remove this in v4\n  get xpathController () {\n    return elementToXPath(this.controllerElement)\n  }\n\n  get xpathElement () {\n    return elementToXPath(this.reflexElement)\n  }\n  // END TODO remove\n\n  get formSelector () {\n    const attr = this.reflexElement.attributes[Schema.reflexFormSelector]\n      ? this.reflexElement.attributes[Schema.reflexFormSelector].value\n      : undefined\n    return this.options['formSelector'] || attr\n  }\n\n  get includeInnerHtml () {\n    const attr =\n      this.reflexElement.attributes[Schema.reflexIncludeInnerHtml] || false\n    return this.options['includeInnerHTML'] || attr\n      ? attr.value !== 'false'\n      : false\n  }\n\n  get includeTextContent () {\n    const attr =\n      this.reflexElement.attributes[Schema.reflexIncludeTextContent] || false\n    return this.options['includeTextContent'] || attr\n      ? attr.value !== 'false'\n      : false\n  }\n\n  get suppressLogging () {\n    return (\n      this.options['suppressLogging'] ||\n      this.reflexElement.attributes[Schema.reflexSuppressLogging] ||\n      false\n    )\n  }\n\n  valueOf () {\n    return {\n      attrs: this.attrs,\n      dataset: this.dataset,\n      selectors: this.selectors,\n      id: this.id,\n      resolveLate: this.resolveLate,\n      suppressLogging: this.suppressLogging,\n      xpathController: this.xpathController,\n      xpathElement: this.xpathElement,\n      inner_html: this.innerHTML,\n      text_content: this.textContent,\n      formSelector: this.formSelector,\n      reflexController: this.reflexController,\n      permanentAttributeName: this.permanentAttributeName,\n      target: this.target,\n      args: this.args,\n      url: this.url,\n      tabId: this.tabId,\n      version: packageInfo.version\n    }\n  }\n}\n","let transport = {}\n\nexport default {\n  get plugin () {\n    return transport\n  },\n  set (newTransport) {\n    transport = newTransport\n  }\n}\n","import CableReady from 'cable_ready'\n\nimport Log from './log'\n\nimport { reflexes } from './reflexes'\nimport { dispatchLifecycleEvent } from './lifecycle'\n\nconst beforeDOMUpdate = event => {\n  const { stimulusReflex } = event.detail || {}\n  if (!stimulusReflex) return\n  const reflex = reflexes[stimulusReflex.id]\n\n  reflex.pendingOperations--\n\n  if (reflex.pendingOperations > 0) return\n\n  // TODO: remove in v4 - always resolve late\n  if (!stimulusReflex.resolveLate)\n    setTimeout(() =>\n      reflex.promise.resolve({\n        element: reflex.element,\n        event,\n        data: reflex.data,\n        payload: reflex.payload,\n        id: reflex.id,\n        toString: () => ''\n      })\n    )\n  // END TODO: remove\n\n  setTimeout(() => dispatchLifecycleEvent(reflex, 'success'))\n}\n\nconst afterDOMUpdate = event => {\n  const { stimulusReflex } = event.detail || {}\n  if (!stimulusReflex) return\n  const reflex = reflexes[stimulusReflex.id]\n\n  reflex.completedOperations++\n  reflex.selector = event.detail.selector\n  reflex.morph = event.detail.stimulusReflex.morph\n  reflex.operation = event.type\n    .split(':')[1]\n    .split('-')\n    .slice(1)\n    .join('_')\n\n  Log.success(reflex)\n\n  if (reflex.completedOperations < reflex.totalOperations) return\n\n  // TODO: v4 always resolve late (remove if)\n  // TODO: v4 simplify to {reflex, toString}\n  if (stimulusReflex.resolveLate)\n    setTimeout(() =>\n      reflex.promise.resolve({\n        element: reflex.element,\n        event,\n        data: reflex.data,\n        payload: reflex.payload,\n        id: reflex.id,\n        toString: () => ''\n      })\n    )\n\n  setTimeout(() => dispatchLifecycleEvent(reflex, 'finalize'))\n\n  if (reflex.piggybackOperations.length)\n    CableReady.perform(reflex.piggybackOperations)\n}\n\nconst routeReflexEvent = event => {\n  const { stimulusReflex, name } = event.detail || {}\n  const eventType = name.split('-')[2]\n\n  const eventTypes = { nothing, halted, forbidden, error }\n\n  if (!stimulusReflex || !Object.keys(eventTypes).includes(eventType)) return\n\n  const reflex = reflexes[stimulusReflex.id]\n  reflex.completedOperations++\n  reflex.pendingOperations--\n  reflex.selector = event.detail.selector\n  reflex.morph = event.detail.stimulusReflex.morph\n  reflex.operation = event.type\n    .split(':')[1]\n    .split('-')\n    .slice(1)\n    .join('_')\n  if (eventType === 'error') reflex.error = event.detail.error\n\n  eventTypes[eventType](reflex, event)\n\n  setTimeout(() => dispatchLifecycleEvent(reflex, eventType))\n\n  if (reflex.piggybackOperations.length)\n    CableReady.perform(reflex.piggybackOperations)\n}\n\nconst nothing = (reflex, event) => {\n  Log.success(reflex)\n\n  // TODO: v4 simplify to {reflex, toString}\n  setTimeout(() =>\n    reflex.promise.resolve({\n      data: reflex.data,\n      element: reflex.element,\n      event,\n      payload: reflex.payload,\n      id: reflex.id,\n      toString: () => ''\n    })\n  )\n}\n\nconst halted = (reflex, event) => {\n  Log.halted(reflex, event)\n\n  // TODO: v4 simplify to {reflex, toString}\n  setTimeout(() =>\n    reflex.promise.resolve({\n      data: reflex.data,\n      element: reflex.element,\n      event,\n      payload: reflex.payload,\n      id: reflex.id,\n      toString: () => ''\n    })\n  )\n}\n\nconst forbidden = (reflex, event) => {\n  Log.forbidden(reflex, event)\n\n  // TODO: v4 simplify to {reflex, toString}\n  setTimeout(() =>\n    reflex.promise.resolve({\n      data: reflex.data,\n      element: reflex.element,\n      event,\n      payload: reflex.payload,\n      id: reflex.id,\n      toString: () => ''\n    })\n  )\n}\n\nconst error = (reflex, event) => {\n  Log.error(reflex, event)\n\n  // TODO: v4 simplify to {reflex, toString}\n  // TODO: v4 convert to resolve?\n  setTimeout(() =>\n    reflex.promise.reject({\n      data: reflex.data,\n      element: reflex.element,\n      event,\n      payload: reflex.payload,\n      id: reflex.id,\n      error: reflex.error,\n      toString: () => reflex.error\n    })\n  )\n}\n\nexport { beforeDOMUpdate, afterDOMUpdate, routeReflexEvent }\n","import App from './app'\nimport Schema from './schema'\n\nimport { attributeValues } from './attributes'\nimport { extractReflexName } from './utils'\n\n// Returns StimulusReflex controllers local to the passed element based on the data-controller attribute.\n//\nconst localReflexControllers = element => {\n  return attributeValues(element.getAttribute(Schema.controller)).reduce(\n    (memo, name) => {\n      const controller = App.app.getControllerForElementAndIdentifier(\n        element,\n        name\n      )\n      if (controller && controller.StimulusReflex) memo.push(controller)\n      return memo\n    },\n    []\n  )\n}\n\n// Returns all StimulusReflex controllers for the passed element.\n// Traverses DOM ancestors starting with element.\n//\nconst allReflexControllers = element => {\n  let controllers = []\n  while (element) {\n    controllers = controllers.concat(localReflexControllers(element))\n    element = element.parentElement\n  }\n  return controllers\n}\n\n// Given a reflex string such as 'click->TestReflex#create' and a list of\n// controllers. It will find the matching controller based on the controller's\n// identifier. e.g. Given these controller identifiers ['foo', 'bar', 'test'],\n// it would select the 'test' controller.\nconst findControllerByReflexName = (reflexName, controllers) => {\n  const controller = controllers.find(controller => {\n    if (!controller.identifier) return\n\n    return (\n      extractReflexName(reflexName)\n        .replace(/([a-z09])([A-Z])/g, '$1-$2')\n        .replace(/(::)/g, '--')\n        .toLowerCase() === controller.identifier\n    )\n  })\n\n  return controller || controllers[0]\n}\n\nexport { allReflexControllers, findControllerByReflexName }\n","import Schema from './schema'\n\nimport { attributeValues, attributeValue } from './attributes'\nimport { debounce, dispatch } from './utils'\nimport { findControllerByReflexName, allReflexControllers } from './controllers'\nimport { reflexes } from './reflexes'\n\n// Sets up declarative reflex behavior.\n// Any elements that define data-reflex will automatically be wired up with the default StimulusReflexController.\n//\nconst scanForReflexes = debounce(() => {\n  const reflexElements = document.querySelectorAll(`[${Schema.reflex}]`)\n  reflexElements.forEach(element => scanForReflexesOnElement(element))\n}, 20)\n\nconst scanForReflexesOnElement = element => {\n  const controllerAttribute = element.getAttribute(Schema.controller)\n  const controllers = attributeValues(controllerAttribute)\n\n  const reflexAttribute = element.getAttribute(Schema.reflex)\n  const reflexAttributeNames = attributeValues(reflexAttribute)\n\n  const actionAttribute = element.getAttribute(Schema.action)\n  const actions = attributeValues(actionAttribute).filter(\n    action => !action.includes('#__perform')\n  )\n\n  reflexAttributeNames.forEach(reflexName => {\n    const controller = findControllerByReflexName(\n      reflexName,\n      allReflexControllers(element)\n    )\n    const controllerName = controller\n      ? controller.identifier\n      : 'stimulus-reflex'\n\n    actions.push(`${reflexName.split('->')[0]}->${controllerName}#__perform`)\n    controllers.push(controllerName)\n  })\n\n  const controllerValue = attributeValue(controllers)\n  const actionValue = attributeValue(actions)\n\n  let emitReadyEvent = false\n\n  if (\n    controllerValue &&\n    element.getAttribute(Schema.controller) != controllerValue\n  ) {\n    element.setAttribute(Schema.controller, controllerValue)\n    emitReadyEvent = true\n  }\n\n  if (actionValue && element.getAttribute(Schema.action) != actionValue) {\n    element.setAttribute(Schema.action, actionValue)\n    emitReadyEvent = true\n  }\n\n  if (emitReadyEvent) {\n    dispatch(element, 'stimulus-reflex:ready', {\n      reflex: reflexAttribute,\n      controller: controllerValue,\n      action: actionValue,\n      element\n    })\n  }\n}\nexport { scanForReflexes, scanForReflexesOnElement }\n","import { Controller } from '@hotwired/stimulus'\n\nimport './version_checker'\n\nimport ActionCableTransport from './transports/action_cable'\nimport App from './app'\nimport Debug from './debug'\nimport Deprecate from './deprecate'\nimport IsolationMode from './isolation_mode'\nimport Log from './log'\nimport Reflex from './reflex'\nimport ReflexData from './reflex_data'\nimport Schema from './schema'\nimport Transport from './transport'\n\nimport { attributeValues } from './attributes'\nimport { beforeDOMUpdate, afterDOMUpdate, routeReflexEvent } from './callbacks'\nimport { dispatchLifecycleEvent } from './lifecycle'\nimport { reflexes } from './reflexes'\nimport { scanForReflexes, scanForReflexesOnElement } from './scanner'\n\nimport {\n  uuidv4,\n  serializeForm,\n  elementInvalid,\n  getReflexElement,\n  getReflexOptions,\n  emitEvent\n} from './utils'\n\n// Default StimulusReflexController that is implicitly wired up as data-controller for any DOM elements\n// that have configured data-reflex. Note that this default can be overridden when initializing the application.\n// i.e. StimulusReflex.initialize(myStimulusApplication, MyCustomDefaultController)\n//\nclass StimulusReflexController extends Controller {\n  constructor (...args) {\n    super(...args)\n    register(this)\n  }\n}\n\n// Uniquely identify this browser tab in each Reflex\nconst tabId = uuidv4()\n\n// Initializes StimulusReflex by registering the default Stimulus controller with the passed Stimulus application.\n//\n// - application  - the Stimulus application\n// - options\n//   * controller - [optional] the default StimulusReflexController\n//   * consumer   - [optional] the ActionCable consumer\n//   * debug      - [false] log all Reflexes to the console\n//   * params     - [{}] key/value parameters to send during channel subscription\n//   * isolate    - [false] restrict Reflex playback to the tab which initiated it\n//   * deprecate  - [true] show warnings regarding upcoming changes to the library\n//   * transport  - [optional] defaults to ActionCableTransport\n//\nconst initialize = (\n  application,\n  { controller, consumer, debug, params, isolate, deprecate, transport } = {}\n) => {\n  Transport.set(transport || ActionCableTransport)\n  Transport.plugin.initialize(consumer, params)\n  IsolationMode.set(!!isolate)\n  App.set(application)\n  Schema.set(application)\n  App.app.register(\n    'stimulus-reflex',\n    controller || StimulusReflexController\n  )\n  Debug.set(!!debug)\n  if (typeof deprecate !== 'undefined') Deprecate.set(deprecate)\n  const observer = new MutationObserver(scanForReflexes)\n  observer.observe(document.documentElement, {\n    attributeFilter: [Schema.reflex, Schema.action],\n    childList: true,\n    subtree: true\n  })\n  emitEvent('stimulus-reflex:initialized')\n}\n\n// Registers a Stimulus controller and extends it with StimulusReflex behavior\n//\n// controller - the Stimulus controller\n// options - [optional] configuration\n//\nconst register = (controller, options = {}) => {\n  const channel = 'StimulusReflex::Channel'\n  controller.StimulusReflex = { ...options, channel }\n  Transport.plugin.subscribe(controller)\n  Object.assign(controller, {\n    // Invokes a server side reflex method.\n    //\n    // - target - the reflex target (full name of the server side reflex) i.e. 'ReflexClassName#method'\n    // - reflexElement - [optional] the element that triggered the reflex, defaults to this.element\n    // - options - [optional] an object that contains at least one of attrs, id, selectors, resolveLate, serializeForm\n    // - *args - remaining arguments are forwarded to the server side reflex method\n    //\n    stimulate () {\n      const url = location.href\n      const controllerElement = this.element\n      const args = Array.from(arguments)\n      const target = args.shift() || 'StimulusReflex::Reflex#default_reflex'\n      const reflexElement = getReflexElement(args, controllerElement)\n\n      if (elementInvalid(reflexElement)) {\n        if (Debug.enabled) console.warn('Reflex aborted: invalid numeric input')\n        return\n      }\n\n      const options = getReflexOptions(args)\n\n      const reflexData = new ReflexData(\n        options,\n        reflexElement,\n        controllerElement,\n        this.identifier,\n        Schema.reflexPermanent,\n        target,\n        args,\n        url,\n        tabId\n      )\n\n      const id = reflexData.id\n\n      // TODO: remove this in v4\n      controllerElement.reflexController =\n        controllerElement.reflexController || {}\n      controllerElement.reflexData = controllerElement.reflexData || {}\n      controllerElement.reflexError = controllerElement.reflexError || {}\n\n      controllerElement.reflexController[id] = this\n      controllerElement.reflexData[id] = reflexData.valueOf()\n      // END TODO: remove\n\n      const reflex = new Reflex(reflexData, this)\n      reflexes[id] = reflex\n      this.lastReflex = reflex\n\n      dispatchLifecycleEvent(reflex, 'before')\n\n      setTimeout(() => {\n        // TODO: in v4, params will be set on the reflex.data object\n        const { params } = controllerElement.reflexData[id] || {}\n\n        const check = reflexElement.attributes[Schema.reflexSerializeForm]\n        if (check) {\n          options['serializeForm'] = check.value !== 'false'\n        }\n\n        const form =\n          reflexElement.closest(reflexData.formSelector) ||\n          document.querySelector(reflexData.formSelector) ||\n          reflexElement.closest('form')\n\n        // TODO: remove this in v4\n        if (Deprecate.enabled && options['serializeForm'] === undefined && form)\n          console.warn(\n            `Deprecation warning: the next version of StimulusReflex will not serialize forms by default.\\nPlease set ${Schema.reflexSerializeForm}=\\\"true\\\" on your Reflex Controller Element or pass { serializeForm: true } as an option to stimulate.`\n          )\n        // END TODO: remove\n\n        const formData =\n          options['serializeForm'] === false\n            ? ''\n            : serializeForm(form, {\n                element: reflexElement\n              })\n\n        reflex.data = {\n          ...reflexData.valueOf(),\n          params,\n          formData\n        }\n\n        // TODO: remove this in v4\n        controllerElement.reflexData[id] = reflex.data\n        // END TODO: remove\n\n        Transport.plugin.deliver(reflex)\n      })\n\n      Log.request(reflex)\n\n      return reflex.getPromise\n    },\n\n    // Wraps the call to stimulate for any data-reflex elements.\n    // This is internal and should not be invoked directly.\n    __perform (event) {\n      let element = event.target\n      let reflex\n\n      while (element && !reflex) {\n        reflex = element.getAttribute(Schema.reflex)\n        if (!reflex || !reflex.trim().length) element = element.parentElement\n      }\n\n      const match = attributeValues(reflex).find(\n        reflex => reflex.split('->')[0] === event.type\n      )\n\n      if (match) {\n        event.preventDefault()\n        event.stopPropagation()\n        this.stimulate(match.split('->')[1], element)\n      }\n    }\n  })\n\n  // Access the reflexes created by the current controller instance\n  // reflexes is a Proxy to an object, keyed by id\n  // this.reflexes.all and this.reflexes.last are scoped to this controller instance\n  // Reflexes can also be scoped by stage eg. this.reflexes.queued\n  if (!controller.reflexes)\n    Object.defineProperty(controller, 'reflexes', {\n      get () {\n        return new Proxy(reflexes, {\n          get: function (target, prop) {\n            if (prop === 'last') return this.lastReflex\n            return Object.fromEntries(\n              Object.entries(target[prop]).filter(\n                ([_, reflex]) => reflex.controller === this\n              )\n            )\n          }.bind(this)\n        })\n      }\n    })\n\n  scanForReflexesOnElement(controller.element)\n\n  emitEvent('stimulus-reflex:controller-registered', { detail: { controller } })\n}\n\nconst useReflex = (controller, options = {}) => {\n  register(controller, options)\n}\n\ndocument.addEventListener('cable-ready:after-dispatch-event', routeReflexEvent)\ndocument.addEventListener('cable-ready:before-inner-html', beforeDOMUpdate)\ndocument.addEventListener('cable-ready:before-morph', beforeDOMUpdate)\ndocument.addEventListener('cable-ready:after-inner-html', afterDOMUpdate)\ndocument.addEventListener('cable-ready:after-morph', afterDOMUpdate)\ndocument.addEventListener('readystatechange', () => {\n  if (document.readyState === 'complete') {\n    scanForReflexes()\n  }\n})\n\nexport {\n  initialize,\n  register,\n  useReflex,\n  reflexes,\n  scanForReflexes,\n  scanForReflexesOnElement\n}\n","export * from './stimulus_reflex'\n\nimport * as StimulusReflex from './stimulus_reflex'\n\nimport Debug from './debug'\nimport Deprecate from './deprecate'\n\nimport packageInfo from '../package.json'\n\nconst global = {\n  version: packageInfo.version,\n  ...StimulusReflex,\n  get debug () {\n    return Debug.value\n  },\n  set debug (value) {\n    Debug.set(!!value)\n  },\n  get deprecate () {\n    return Deprecate.value\n  },\n  set deprecate (value) {\n    Deprecate.set(!!value)\n  }\n}\n\nwindow.StimulusReflex = global\n\nexport default global\n"],"names":["Toastify","defaults","oldestFirst","text","node","undefined","duration","selector","callback","destination","newWindow","close","gravity","positionLeft","position","backgroundColor","avatar","className","stopOnFocus","onClick","offset","x","y","escapeMarkup","ariaLive","style","background","constructor","options","this","version","toastElement","_rootElement","document","body","_init","showToast","_buildToast","getElementById","HTMLElement","ShadowRoot","insertBefore","firstChild","_reposition","timeOutValue","window","setTimeout","_removeElement","hideToast","clearTimeout","Object","assign","console","warn","divElement","createElement","property","setAttribute","nodeType","Node","ELEMENT_NODE","appendChild","innerText","innerHTML","avatarElement","src","insertAdjacentElement","closeElement","type","addEventListener","event","stopPropagation","width","innerWidth","screen","open","location","_getAxisOffsetAValue","xOffset","yOffset","transform","replace","parentNode","removeChild","call","classUsed","topLeftOffsetSize","top","bottom","topRightOffsetSize","offsetSize","allToasts","querySelectorAll","i","length","classList","contains","height","offsetHeight","substr","axis","isNaN","setupToastify","id","element","querySelector","documentElement","styles","head","CableReady","operations","stimulusReflexVersionMismatch","operation","info","success","error","level","deprecationWarnings","Deprecate","enabled","disabled","value","set","deprecate","debugging","Debug$1","debug","defaultSchema","reflexAttribute","reflexPermanentAttribute","reflexRootAttribute","reflexSuppressLoggingAttribute","reflexDatasetAttribute","reflexDatasetAllAttribute","reflexSerializeFormAttribute","reflexFormSelectorAttribute","reflexIncludeInnerHtmlAttribute","reflexIncludeTextContentAttribute","schema","Schema","application","attribute","attributeName","slice","defineProperty","get","configurable","debounce","dispatch","xpathToElement","xpathToElementArray","Utils","uuidv4","crypto","msCrypto","c","getRandomValues","Uint8Array","toString","camelize","uppercaseFirstLetter","$1","toUpperCase","toLowerCase","XPathToElement","XPathToArray","emitEvent","name","detail","elementToXPath","nodeName","ix","siblings","childNodes","sibling","tagName","stages","lastReflex","reflexes","Proxy","target","prop","includes","fromEntries","entries","filter","_","reflex","stage","Reflect","arguments","invokeLifecycleMethod","specificLifecycleMethod","controller","action","genericLifecycleMethod","payload","dispatchLifecycleEvent","parentElement","Debug","warned","lifecycle","push","bubbles","cancelable","dispatchEvent","CustomEvent","jQuery","trigger","app","App","isolationMode","IsolationMode","once","Reflex","data","valueOf","reflexElement","split","morph","timestamp","Date","cloned","getPromise","promise","Promise","resolve","reject","catch","received","cableReady","reflexData","reflexOperations","stimulusReflex","splice","some","url","href","controllerElement","xpathController","xpathElement","reflexController","reflexError","getControllerForElementAndIdentifier","totalOperations","pendingOperations","completedOperations","piggybackOperations","perform","reflexId","consumer","params","subscription","active","connected","connectionStatusClass","values","queued","forEach","send","rejected","disconnected","willAttemptReconnect","list","add","ActionCableTransport","subscribe","createConsumer","channel","StimulusReflex","request","identifier","JSON","stringify","subscriptions","findAll","create","deliver","initialize","consumerValue","paramsValue","progress","Log","suppressLogging","log","args","output","attributeValue","Array","from","Set","v","String","map","trim","join","attributeValues","extractElementAttributes","attrs","attributes","reduce","memo","attr","checked","selected","tag_name","match","multipleInstances","collectedOptions","concat","elem","o","collectCheckedOptions","getElementsFromTokens","tokens","elements","xPath","token","extractDataAttributes","startsWith","ReflexData","permanentAttributeName","tabId","_attrs","_id","selectors","_selectors","reflexRoot","getAttribute","s","closest","getReflexRoots","resolveLate","dataset","_dataset","reflexDataset","allDataset","reflexDatasetAll","allTokens","datasetElements","datasetAllElements","datasetAttributes","acc","ele","elementDataset","datasetAll","elementAttributes","keys","key","isArray","extractElementDataset","includeInnerHtml","textContent","includeTextContent","formSelector","reflexFormSelector","reflexIncludeInnerHtml","reflexIncludeTextContent","reflexSuppressLogging","inner_html","text_content","packageInfo","transport","Transport","plugin","newTransport","beforeDOMUpdate","afterDOMUpdate","nothing","halted","forbidden","localReflexControllers","scanForReflexes","scanForReflexesOnElement","controllerAttribute","controllers","reflexAttributeNames","actionAttribute","actions","reflexName","find","reflexString","extractReflexName","findControllerByReflexName","allReflexControllers","controllerName","controllerValue","actionValue","emitReadyEvent","StimulusReflexController","Controller","super","register","isolate","MutationObserver","observe","attributeFilter","childList","subtree","stimulate","shift","getReflexElement","validity","badInput","opts","getReflexOptions","reflexPermanent","check","reflexSerializeForm","form","formData","w","FormData","e","encodeURIComponent","submitButton","serializeForm","__perform","preventDefault","bind","useReflex","eventType","eventTypes","readyState","global"],"mappings":"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"}